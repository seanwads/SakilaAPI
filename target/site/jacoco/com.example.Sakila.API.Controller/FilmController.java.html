<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>FilmController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Sakila-API</a> &gt; <a href="index.source.html" class="el_package">com.example.Sakila.API.Controller</a> &gt; <span class="el_source">FilmController.java</span></div><h1>FilmController.java</h1><pre class="source lang-java linenums">package com.example.Sakila.API.Controller;

import com.example.Sakila.API.Model.Category;
import com.example.Sakila.API.Model.Film;
import com.example.Sakila.API.Repository.FilmRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.client.ResourceAccessException;

import java.util.Set;

@CrossOrigin
@RequestMapping(&quot;/film&quot;)
@RestController
public class FilmController {

    private final FilmRepository filmRepository;
    private static final String notFoundResponse = &quot;Film not found&quot;;

    @Autowired
<span class="fc" id="L21">    public FilmController(FilmRepository filmRepository){</span>
<span class="fc" id="L22">        this.filmRepository = filmRepository;</span>
<span class="fc" id="L23">    }</span>

    @GetMapping(&quot;/get/{id}&quot;)
    public Film getFilmById(@PathVariable(&quot;id&quot;) int filmId){
<span class="pc" id="L27">        return filmRepository.findById(filmId).orElseThrow(() -&gt; new ResourceAccessException(notFoundResponse));</span>
    }

    @GetMapping(&quot;/getAll&quot;)
    public Iterable&lt;Film&gt; getAllFilms(){
<span class="fc" id="L32">        return filmRepository.findAll();</span>
    }

    @GetMapping(&quot;/getCategories/{id}&quot;)
    public Set&lt;Category&gt; getCategoriesByFilm(@PathVariable(&quot;id&quot;) int filmId){
<span class="pc" id="L37">        Film film = filmRepository.findById(filmId).orElseThrow(() -&gt; new ResourceAccessException(notFoundResponse));</span>
<span class="fc" id="L38">        return film.getCategorySet();</span>
    }

    @GetMapping(&quot;/getByTitle/{title}&quot;)
    public Iterable&lt;Film&gt; getFilmsByTitle(@PathVariable(&quot;title&quot;) String titleInput){
<span class="nc" id="L43">        return filmRepository.findByTitleContains(titleInput);</span>
    }

    @GetMapping(&quot;/getByCatId/{id}&quot;)
    public Iterable&lt;Film&gt; getFilmsByCatId(@PathVariable(&quot;id&quot;) int catId){
<span class="nc" id="L48">        return filmRepository.findByCategoryId(catId);</span>
    }

    @GetMapping(&quot;/getByCatName/{catName}&quot;)
    public Iterable&lt;Film&gt; getFilmsByCatName(@PathVariable(&quot;catName&quot;) String catName){
<span class="nc" id="L53">        return filmRepository.findByCategoryName(catName);</span>
    }

    @PutMapping(&quot;/update/{id}&quot;)
    public Film updateFilmById(
            @PathVariable(&quot;id&quot;) int filmId,
            @RequestBody Film updatedFilm
    ){
<span class="nc" id="L61">        Film film = filmRepository.findById(filmId).orElseThrow(() -&gt; new ResourceAccessException(notFoundResponse));</span>

<span class="nc" id="L63">        film.setTitle(updatedFilm.getTitle());</span>
<span class="nc" id="L64">        film.setDescription(updatedFilm.getDescription());</span>
<span class="nc" id="L65">        film.setRating(updatedFilm.getRating());</span>
<span class="nc" id="L66">        film.setLanguageId(updatedFilm.getLanguageId());</span>
<span class="nc" id="L67">        film.setCategorySet(updatedFilm.getCategorySet());</span>

<span class="nc" id="L69">        return filmRepository.save(film);</span>
    }

    @PostMapping(&quot;/create&quot;)
    public Film createFilm(@RequestBody Film newFilm){
<span class="nc" id="L74">        return filmRepository.save(newFilm);</span>
    }

    @DeleteMapping(&quot;/delete/{id}&quot;)
    public void deleteFilmById(@PathVariable(&quot;id&quot;) int filmId){
<span class="nc" id="L79">        filmRepository.deleteById(filmId);</span>
<span class="nc" id="L80">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>